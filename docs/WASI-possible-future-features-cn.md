这个文件讨论了在POSIX环境下，一些尚未实现但值得关注的未来特性，以及它们可能需要的一些设计工作。这些特性包括文件锁定、文件变更监控、可扩展的事件驱动I/O和崩溃恢复。

### 文件锁定
文件锁定在POSIX中的解决方案是使用`fcntl`与`F_SETLK`/`F_GETLK`等操作，这些操作提供建议性的记录锁定。但这些锁与进程相关联，如果程序的两个部分独立打开同一个文件并尝试锁定它，如果它们在同一个进程中，它们将自动共享锁。其他锁定API在不同平台上存在，但并没有广泛标准化。SQLite使用的是POSIX `F_SETLK`风格的锁定。

### 文件变更监控
POSIX没有提供一种高效的方式来监控大量文件或目录的变更。许多流行的操作系统有特定的系统API来实现这一功能，因此设计一个可移植的API来提供这种功能将是可取的。

### 可扩展的事件驱动I/O
POSIX的`select`和`poll`在每次调用时都需要遍历所有文件描述符以报告是否有任何I/O准备就绪，当有大量打开的文件或套接字时，这种操作是低效的。许多流行的操作系统有特定的系统API提供替代方法来监控大量I/O流，因此设计一个可移植的API来提供这种功能将是可取的。

### 崩溃恢复
POSIX对于系统崩溃或存储设备突然离线时，应用程序可以期望其数据是什么样子没有明确的指导。我们有`fsync`和`fdatasync`，但即使这些也曾是广泛讨论的话题。目前WASI的文档也没有对诸如`path_rename`这样的操作是否原子做出任何保证。

---

**总结：**
这个文件概述了在POSIX兼容系统中，一些可能的未来特性，这些特性旨在提高文件操作的效率和可靠性。文件锁定、文件变更监控、可扩展的事件驱动I/O和崩溃恢复都是操作系统和数据库系统（如SQLite）中常见的需求，但在POSIX标准中并没有统一或高效的解决方案。这些特性的实现可能需要跨平台的API设计，以确保在不同操作系统上的兼容性和性能。此外，文件中提到的[fsync错误讨论](https://wiki.postgresql.org/wiki/Fsync_Errors)是关于数据同步和存储可靠性的重要话题，特别是在系统崩溃或存储设备突然离线时数据的完整性问题。
